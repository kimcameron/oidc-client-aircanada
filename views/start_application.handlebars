<link href="/style.css" rel="stylesheet">

<div id="page" style="display:none">

<!-- Navigation -->
<nav class="navbar navbar-expand-md navbar-light bg-light sticky-top">
<div class="container-fluid">
  <a class="navbar-brand" href="#"><img src="/web/img/logo.png"></a>
  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarResponsive">
    <span class="navbar-toggler-icon"></span>
  </button>
  <div class="collapse navbar-collapse" id="navbarResponsive">
    <ul class="navbar-nav ml-auto">
      <li class="nav-item active">
        <a class="nav-link" href="#">Book</a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="#">Plan</a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="#">Fly</a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="#">Loyalty</a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="#">Login</a>
      </li>
    </ul>
  </div>
</div>
</nav>

<!-- CleanCare section -->
<header>
  <img src="/web/img/lg-cleancare.jpg">
</header>

<!--- Welcome Section -->
<div class="container-fluid padding">
<div class="row welcome text-center">
  <div class="col-12">
    <br/><br/>
    <h1 class="display-4">Scan to enter the Covid Safe Cabin.</h1>
  </div>
  <div class="col-12">
    <br/>
    <div id="siop_qr_code"></div>
    <div id="mqtt_connect" style="display:none">
      <span class="cg_details fas fa-mobile-alt" style="font-size:2em;"></span>
    <div>
  </div>
</div>
</div>

<div id="remote_cookie_reader"></div>
<input type="hidden" id="app_instance_params" value="{{app_instance_params}}">
<input type="hidden" id="app_config_params" value="{{app_config_params}}">

</div>

<!-- These three scripts must be included to use all features of the oidc_app_instance api -->
<script src="{{client_api_url}}/oidc_app_instance.js"></script>
<script src="{{client_api_url}}/mqttws31.js"></script>
<script src="{{client_api_url}}/siop_mqtt_client.js"></script>

<script>
  
  var app_instance = new oidc_app_instance('app_config_params', 'app_instance_params', autoProceed);
  app_instance.startup();

  function autoProceed(discovery_info, wallet_url){
    if (wallet_url){
      window.location = discovery_info.credential_request_url;
      return false;
    }
    else{
      var pageEl = document.getElementById("page")
      pageEl.setAttribute("style", "display: block");
      siop_set_img(discovery_info);
      if (discovery_info.rwl){
        siop_mqtt_client(discovery_info);
      }      
    }
  }
</script>

